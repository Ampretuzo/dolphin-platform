<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-scaffold/core-scaffold.html">
<link rel="import" href="../bower_components/core-menu/core-menu.html">
<link rel="import" href="../bower_components/core-menu/core-submenu.html">
<link rel="import" href="../bower_components/core-item/core-item.html">



<polymer-element name="workflow-menuentry" attributes="data" extends="core-item" noscript>
    <template>
        <shadow></shadow>
    </template>
</polymer-element>


<polymer-element name="workflow-menu" attributes="data">
    <template>
        <core-menu on-core-select="{{selectAction}}">
            <template repeat="{{processDefinition in data.processDefinitions}}">
                <core-submenu label="{{processDefinition.name}}">
                    <template repeat="{{processInstance in processDefinition.processInstances}}">
                        <workflow-menuentry label="{{processInstance.label}}" data="{{processInstance}}"></workflow-menuentry>
                    </template>
                </core-submenu>
            </template>
        </core-menu>
    </template>
    <script>
        Polymer({
            selectAction: function(e, detail) {
                if (detail.isSelected) {
                    var selectedItem = detail.item.data;
                    if (typeof selectedItem !== 'undefined') {
                        window.dolphin.send('WorkflowController:showProcessInstance', {processInstance: selectedItem});
                    }
                }
            }
        })
    </script>
</polymer-element>


<polymer-element name="workflow-main-view" attributes="data" noscript>
    <template>
        <core-scaffold>
            <core-header-panel navigation flex mode="seamed">
                <core-toolbar>Dolphin Workflow</core-toolbar>
                <workflow-menu data="{{data.processList}}"></workflow-menu>
            </core-header-panel>
            <div tool>Process Instance {{data.processInstance.label}}</div>
            <div>Main content goes here...</div>
        </core-scaffold>
    </template>
</polymer-element>
